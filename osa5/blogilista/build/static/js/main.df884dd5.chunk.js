(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{23:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(17),a=n.n(c),u=n(8),i=n(1),s=n.n(i),o=n(5),l=n(4),d=(n(23),n(0)),j=function(e){var t=e.blog,n=e.username,c=e.handleLike,a=e.handleDelete,u=Object(r.useState)(!1),i=Object(l.a)(u,2),s=i[0],o=i[1];return Object(d.jsxs)("div",{className:"blogBox",children:[Object(d.jsxs)("p",{children:[t.title," ",t.author,Object(d.jsx)("button",{onClick:function(){o(!s)},children:s?"hide":"show"})]}),s&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("p",{children:t.url}),Object(d.jsxs)("p",{children:["likes ",t.likes," ",Object(d.jsx)("button",{blogid:t.id,onClick:c,children:"like"})]}),Object(d.jsx)("p",{children:t.user.name}),n===t.user.username&&Object(d.jsx)("button",{blogid:t.id,onClick:a,children:"delete"})]})]})},b=function(e){var t=e.handleLogin,n=e.username,r=e.handleUsername,c=e.password,a=e.handlePassword;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h3",{children:"Please, log in:"}),Object(d.jsxs)("form",{onSubmit:t,children:[Object(d.jsxs)("div",{children:["username:",Object(d.jsx)("input",{type:"text",name:"Username",value:n,onChange:r})]}),Object(d.jsxs)("div",{children:["password:",Object(d.jsx)("input",{type:"text",name:"Password",value:c,onChange:a})]}),Object(d.jsx)("button",{type:"submit",children:"login"})]})]})},h=function(e){var t=e.user,n=e.handleLogout;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h3",{children:"Logged in as:"}),Object(d.jsxs)("div",{children:[t.name," (",t.username,")"]}),Object(d.jsx)("button",{onClick:n,children:"logout"})]})},f=function(e){var t=e.handleCreate,n=e.title,r=e.handleTitle,c=e.author,a=e.handleAuthor,u=e.url,i=e.handleUrl;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h3",{children:"create new"}),Object(d.jsxs)("form",{onSubmit:t,children:[Object(d.jsxs)("div",{children:["title:",Object(d.jsx)("input",{type:"text",name:"Title",value:n,onChange:r})]}),Object(d.jsxs)("div",{children:["author:",Object(d.jsx)("input",{type:"text",name:"Author",value:c,onChange:a})]}),Object(d.jsxs)("div",{children:["url:",Object(d.jsx)("input",{type:"text",name:"Url",value:u,onChange:i})]}),Object(d.jsx)("button",{type:"submit",children:"create"})]})]})},p=function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),c=n[0],a=n[1],u={display:c?"none":""},i={display:c?"":"none"},s=function(){a(!c)};return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{style:u,children:Object(d.jsx)("button",{onClick:s,children:e.buttonLabel})}),Object(d.jsxs)("div",{style:i,children:[e.children,"        ",Object(d.jsx)("button",{onClick:s,children:"cancel"})]})]})},O=n(6),x=n.n(O),v="/api/blogs",g=null,m={getAll:function(){return x.a.get(v).then((function(e){return e.data}))},setToken:function(e){g="bearer ".concat(e)},create:function(){var e=Object(o.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,x.a.post(v,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(o.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,x.a.put("".concat(v,"/").concat(t.id),t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),del:function(){var e=Object(o.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,x.a.delete("".concat(v,"/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},k={login:function(){var e=Object(o.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w=(n(43),function(){return Object(d.jsx)("h2",{children:"blogs"})}),y=function(e){var t=e.notice,n=e.handleNotice;return null===t?Object(d.jsx)("div",{className:"noticeBox"}):Object(d.jsx)("div",{className:"noticeBox",children:Object(d.jsx)("div",{className:t.toLowerCase().startsWith("error")?"errorNotice":"infoNotice",onClick:n,children:t})})},S=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),i=Object(l.a)(a,2),O=i[0],x=i[1],v=Object(r.useState)(""),g=Object(l.a)(v,2),S=g[0],C=g[1],L=Object(r.useState)(""),N=Object(l.a)(L,2),T=N[0],A=N[1],D=Object(r.useState)(null),U=Object(l.a)(D,2),B=U[0],E=U[1],I=Object(r.useState)(""),J=Object(l.a)(I,2),P=J[0],R=J[1],z=Object(r.useState)(""),F=Object(l.a)(z,2),W=F[0],q=F[1],G=Object(r.useState)(""),H=Object(l.a)(G,2),K=H[0],M=H[1],Q=function(e){E(e),setTimeout((function(){E(null)}),5e3)},V=function(e,t){return e.likes<t.likes};Object(r.useEffect)((function(){m.getAll().then((function(e){return c(e.sort(V))}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("credentials");if(e){var t=JSON.parse(e);x(t)}}),[]);var X=function(){return E(null)},Y=function(){var e=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("credentials"),Q("Lugged out successfully"),x(null);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=Object(o.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,k.login({username:S,password:T});case 4:n=e.sent,m.setToken(n.token),window.localStorage.setItem("credentials",JSON.stringify(n)),Q("Successfully logged in as ".concat(n.username)),x(n),C(""),A(""),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),Q("ERROR: wrogn credentials!");case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(o.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),r={title:P,author:W,url:K},m.setToken(O.token),m.create(r).then((function(e){c(n.concat(e)),Q("Successfully added blog ".concat(e.title)),R(""),q(""),M("")})).catch((function(e){return Q(e.toString())}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(o.a)(s.a.mark((function e(t){var r,a,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),r=t.target.attributes.blogid.value,a=n.find((function(e){return e.id===r})),i=Object(u.a)(Object(u.a)({},a),{},{likes:a.likes+1}),m.setToken(O.token),m.update(i).then((function(e){c(n.filter((function(e){return e.id!==r})).concat(e).sort(V)),Q("Successfully liked blog ".concat(e.title))})).catch((function(e){return Q(e.toString())}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(o.a)(s.a.mark((function e(t){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=t.target.attributes.blogid.value,a=n.find((function(e){return e.id===r})),window.confirm("Remove blog ".concat(a.title))){e.next=5;break}return e.abrupt("return");case 5:m.setToken(O.token),m.del(r).then((function(){c(n.filter((function(e){return e.id!==r})).sort(V)),Q("Successfully deleted blog ".concat(a.title))})).catch((function(e){return Q(e.toString())}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return!(null===O)?Object(d.jsxs)("div",{children:[Object(d.jsx)(w,{}),Object(d.jsx)(y,{notice:B,handleNotice:X}),Object(d.jsx)(h,{user:O,handleLogout:Y}),Object(d.jsx)(p,{buttonLabel:"add blog",children:Object(d.jsx)(f,{handleCreate:$,title:P,handleTitle:function(e){return R(e.target.value)},author:W,handleAuthor:function(e){return q(e.target.value)},url:K,handleUrl:function(e){return M(e.target.value)}})}),n.map((function(e){return Object(d.jsx)(j,{blog:e,username:O.username,handleLike:_,handleDelete:ee},e.id)}))]}):Object(d.jsxs)("div",{children:[Object(d.jsx)(w,{}),Object(d.jsx)(y,{notice:B,handleNotice:X}),Object(d.jsx)(p,{buttonLabel:"login",children:Object(d.jsx)(b,{handleLogin:Z,username:S,handleUsername:function(e){return C(e.target.value)},password:T,handlePassword:function(e){return A(e.target.value)}})})]})};a.a.render(Object(d.jsx)(S,{}),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.df884dd5.chunk.js.map